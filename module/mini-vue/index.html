<html lang="zh">
  <head>
    <title>Mini Vue Demo</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
  </head>
  <body style="margin: 0;">
    <p
      style="
        display: -webkit-box;
        margin: 0;
        padding: 0.5em;
        background: #eee;
        color: #cacaca;
        -webkit-box-orient: vertical;
        -webkit-line-clamp: 4;
        overflow: hidden;
        user-select: none;
        word-break: break-all;
        line-height: 1.5;
        font-size: 12px;
        letter-spacing: 1px;
      "
    >
      <span>MiniVueMiniVueMiniVueMiniVueMiniVue</span>
      <span>MiniVueMiniVueMiniVueMiniVueMiniVue</span>
      <span>MiniVueMiniVueMiniVueMiniVueMiniVue</span>
      <span>MiniVueMiniVueMiniVueMiniVueMiniVue</span>
      <span>MiniVueMiniVueMiniVueMiniVueMiniVue</span>
      <span>MiniVueMiniVueMiniVueMiniVueMiniVue</span>
      <span>MiniVueMiniVueMiniVueMiniVueMiniVue</span>
      <span>MiniVueMiniVueMiniVueMiniVueMiniVue</span>
      <span>MiniVueMiniVueMiniVueMiniVueMiniVue</span>
      <span>MiniVueMiniVueMiniVueMiniVueMiniVue</span>
      <span>MiniVueMiniVueMiniVueMiniVueMiniVue</span>
      <span>MiniVueMiniVueMiniVueMiniVueMiniVue</span>
      <span>MiniVueMiniVueMiniVueMiniVueMiniVue</span>
      <span>MiniVueMiniVueMiniVueMiniVueMiniVue</span>
      <span>MiniVueMiniVueMiniVueMiniVueMiniVue</span>
      <span>MiniVueMiniVueMiniVueMiniVueMiniVue</span>
      <span>MiniVueMiniVueMiniVueMiniVueMiniVue</span>
      <span>MiniVueMiniVueMiniVueMiniVueMiniVue</span>
      <span>MiniVueMiniVueMiniVueMiniVueMiniVue</span>
      <span>MiniVueMiniVueMiniVueMiniVueMiniVue</span>
      <span>MiniVueMiniVueMiniVueMiniVueMiniVue</span>
      <span>MiniVueMiniVueMiniVueMiniVueMiniVue</span>
      <span>MiniVueMiniVueMiniVueMiniVueMiniVue</span>
      <span>MiniVueMiniVueMiniVueMiniVueMiniVue</span>
      <span>MiniVueMiniVueMiniVueMiniVueMiniVue</span>
      <span>MiniVueMiniVueMiniVueMiniVueMiniVue</span>
      <span>MiniVueMiniVueMiniVueMiniVueMiniVue</span>
      <span>MiniVueMiniVueMiniVueMiniVueMiniVue</span>
      <span>MiniVueMiniVueMiniVueMiniVueMiniVue</span>
      <span>MiniVueMiniVueMiniVueMiniVueMiniVue</span>
      <span>MiniVueMiniVueMiniVueMiniVueMiniVue</span>
      <span>MiniVueMiniVueMiniVueMiniVueMiniVue</span>
    </p>
    <div id="app"></div>
  </body>
  <script>
    function dedent (str) {
      const minCount = Math.min.apply(null, str
        .match(/(\r?\n)(\s+)/g)
        .map(x => x.slice(1))
        .map(x => x.length)
      )
      return str.replace(new RegExp(`(\\r?\\n)(\\s{${minCount}})`, 'g'), '$1')
    }

    window.onload = () => {
      const Vue = module
      let sectionCount = 1
      const createSection = (msg, vue, pre, titleTag = 'h2') => {
        const $app = document.querySelector('#app')
        const $content = document.createElement('div')
        const $vmount = document.createElement('div')
        const $title = document.createElement(titleTag)

        $content.setAttribute('class', `section-content-${sectionCount++}`)
        $title.innerText = msg

        $app.appendChild($content)
        $content.appendChild($title)
        $content.appendChild($vmount)
        vue  && vue.$mount($vmount)
        if (pre) {
          const $pre = document.createElement('pre')
          $pre.innerText = pre ? dedent(String(pre)) : ''
          $content.appendChild($pre)
        }

        return vue
      }

      createSection('E2E Test Cases', undefined, undefined, 'h1')

      ;(function create () {
        createSection('# multy root template', new Vue({
          template: `
            <!-- hello comment -->
            <div><h5>Root NO. 1</h5> <dd><dt>first line</dt><dt>second line</dt><dt>third line</dt></dd></div>
            <div><h5>Root NO. 2</h5> <dd><dt>first line</dt><dt>second line</dt><dt>third line</dt></dd></div>
            <div><h5>Root NO. 3</h5> <dd><dt>first line</dt><dt>second line</dt><dt>third line</dt></dd></div>
          `
        }), create)
      })()

      ;(function create () {
        const vue = createSection('# template value binding', new Vue({
          template: `<div>Count: {{ this.count }}</div>`,
          data () { return { count: 990 } }
        }), create)
        setInterval(() => vue._data.count++, 1000)
      })()

      ;(function create () {
        const vue = createSection('# DOM prop binding', new Vue({
          template: `
            <p>Switch Result: {{ this.switch }}</p>
            <button :disabled="!this.switch">{{ this.switch ? 'button' : 'disabled' }}</button>
            <button :disabled="this.switch">{{ !this.switch ? 'button' : 'disabled' }}</button>
          `,
          data () { return { switch: true } }
        }), create)
        setInterval(() => vue._data.switch  = !vue._data.switch, 2000)
      })()

      ;(function create () {
        const vue = createSection('# DOM event', new Vue({
          template: `
            <p>Count Result: {{ this.count }}</p>
            <p>Click "+" to add 1, "-" to dec 1.</p>
            <button @click="() => this.count++">+</button>
            <button @click="() => this.count--">-</button>
          `,
          data () { return { count: 1 } }
        }), create)
      })()
    }
  </script>
</html>
